<!DOCTYPE html>

<!--
Car Cricket
(c) 2020 dragonwocky <thedragonring.bod@gmail.com>
(https://dragonwocky.me/) under the MIT License
-->

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Car Cricket</title>
    <link rel="icon" href="assets/web-icon.png" type="image/png" />
    <link rel="apple-touch-icon" href="assets/apple-icon.png" />
    <meta name="author" content="dragonwocky" />
    <meta name="theme-color" content="#B20000" />

    <meta name="twitter:site" content="@TheDragonRing" />
    <meta name="twitter:creator" content="@TheDragonRing" />

    <meta property="og:type" content="website" />
    <meta property="og:title" content="Car Cricket" />
    <meta property="og:url" content="https://dragonwocky.me/car-cricket/" />
    <meta property="og:description" content="//desc//" />
    <meta
      property="og:image"
      content="https://dragonwocky.me/car-cricket/assets/web-icon.png"
    />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Sear.js" />
    <meta name="twitter:description" content="//desc//" />
    <meta
      name="twitter:image"
      content="https://dragonwocky.me/car-cricket/assets/web-icon.png"
    />

    <link
      href="https://fonts.googleapis.com/css?family=Nunito+Sans&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/styles.css" />
    <script src="assets/sear.0.4.4.js"></script>
    <script src="assets/scripts.js"></script>
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
  </head>
  <body>
    <section :else="persisted.playing" id="menu">
      <div class="title">
        <img src="assets/web-icon.png" />
        <h1>Car Cricket</h1>
      </div>

      <!--
        title
        
        team name
        game mode
        (warnings)

        start
        history
      -->
      <div class="interaction">
        <label for="teamname">team name</label>
        <input
          id="teamname"
          :value="persisted.team"
          :bind:class="warn,warn"
          placeholder="team name"
          type="text"
          onkeyup="if (event.key === 'Enter') start()"
        />
        <p class="detail" :bind:class="warn,warn">
          a team name is required.
        </p>
        <label for="gamemode">select match</label>
        <select id="gamemode" :value="persisted.type">
          <option value="free">freeplay</option>
          <option value="test">test match</option>
          <option value="t20">T20</option>
          <option value="day">one day international</option>
        </select>
        <!--
          (Free play) Wickets are runs are unlimited. You can keep playing until you press "End Innings."
          (Test Match) The innings ends when ten wickets have fallen, or you can "declare" by pressing "End Innings."
          (T20) The innings ends when either: ten wickets have fallen, or 20 cars have passed.
          {One Day International} The innings ends when either: ten wickets have fallen, or 50 cars have passed.
        -->
        <p class="detail">
          <i>(conditions)</i> <span id="conditions" :text="conditions"></span>
        </p>
      </div>
      <div class="actions">
        <button onclick="start()">start innings</button>
        <button onclick="history()">history</button>
      </div>
    </section>
    <section :if="persisted.playing" id="game">
      <div class="interaction">
        <button class="white" onclick="score(1)">one</button>
        <button class="grey" onclick="score(2)">two</button>
        <button class="blue" onclick="score(3)">three</button>
        <button class="black" onclick="score(4)">four</button>
        <button class="pink" onclick="score(5)">five</button>
        <button class="yellow" onclick="score(6)">six</button>
        <button
          class="red"
          onclick="app.persisted.wickets++; app.persisted.balls++"
        >
          wicket
        </button>
      </div>
      <br />
      <p class="detail">
        team:
        <b><span :text="persisted.team"></span></b> | score:
        <b><span :text="persisted.wickets"></span></b> for
        <b><span :text="persisted.runs"></span></b> | overs:
        <b><span :text="overs"></span></b> | time:
        <b><span :text="time"></span></b>
      </p>
      <br />
      <div class="actions">
        <button onclick="ask('you are about to end this innings.', end)">end innings</button>
        <button onclick="history()">history</button>
      </div>
    </section>

    <section id="slideup" :bind:class="popup.open,open">
      <div id="drag" onclick="popup.toggle()">
        <span id="tag" > </span>
      </div>
      <div class="padded">
       <div :bind:style="popup.check,display:block" style="display:none">
          <h4>are you sure?</h4>
          <p :html="popup.check"></p>
          <button class="action" onclick="sure()">yes</button>
          <button class="action" onclick="app.popup.check = '';">cancel</button>
        </div>
      
        <div :bind:style="popup.check,display:none" style="display:block">
          <h4 :text="popup.title"></h4>
          <p :text="popup.content"></p>
          <div :bind:style="popup.history,display:block" style="display:none">
             <div :each="persisted.history">
               <div class="sidebyside">
                 <p><i>[[:each:id]]</i>. [[:each:value:html]]</p>
                 <button onclick="ask(`you are about to delete the below history record: <br /> <i>[[:each:id]]</i>. [[:each:value:html]]`, () => { app.persisted.history.splice('[[:each:id]]' - 1, 1); app.popup.check = '' })">delete</button>
              </div>
            </div>
            <br />
            <button class="action" onclick="ask('you are about to delete all history records.', () => { app.persisted.history = []; app.popup.check = '' })">clear</button>
          </div>
        </div>
      </div>
    </section>
    
    <script>
      if ('serviceWorker' in navigator)
        navigator.serviceWorker.register('service-worker.js', {
          scope: '/car-cricket/'
        });
    </script>
  </body>
</html>
